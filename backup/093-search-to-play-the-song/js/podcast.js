var db;const Pod={$input:$("#podInput"),$search:$("#podSearch"),imgWrap:".podAlbums imgWrap",DB_NAME:"sps",DB_VERSION:1,DB_STORE_NAME:"podcast",HOME_SEARCH_MODE:"search_mode",method:{renderAlbums:e=>{let t=document.createDocumentFragment();e.results.forEach(e=>{const a=document.createElement("li"),d=`\n          <div class="imgWrap">\n            <img src=${e.artworkUrl100} data-xml=${e.feedUrl} />\n          </div>\n          <div class="contWrap">\n            <p alt=${e.collectionCensoredName}>${e.collectionCensoredName}</p> \n            <i alt=${e.artistName}>${e.artistName}</i>\n          </div>\n        `;a.innerHTML=d,t.appendChild(a)}),$(".podAlbums ul").html(t)},renderSounds:e=>{let t=document.createDocumentFragment();e.forEach(e=>{const a=document.createElement("li"),d=e.title.replace(/\s/g,""),s=`\n          <dl>\n            <dt>${e.title}</dt>\n            <dd>发布: ${e.date}, 时长: ${e.duration}</dd>\n          </dl>\n        `,n=`\n          <span>\n            <svg data-date=${e.date} data-duration=${e.duration} data-title=${d} data-url=${e.url} t="1519384078654" class="icon itune_play" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4449" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24"><defs><style type="text/css"></style></defs><path d="M215.618291 917.834029c-55.520501 0-93.25901-44.607964-93.25901-110.988814l0-671.442362c0-66.38085 37.738509-110.98779 93.285616-110.98779 21.22951 0 43.632753 6.590092 66.121953 19.571754L810.298362 380.317888c39.064714 22.529109 61.195757 55.017034 61.195757 90.87266 0 35.815717-22.01234 68.263733-62.018495 91.362824L282.721595 897.664663C259.224438 911.256216 236.847801 917.834029 215.618291 917.834029zM215.644897 78.729086c-34.794457 0-38.971593 39.634696-38.971593 56.673767l0 671.442362c0 17.040095 4.177136 56.67479 38.944987 56.67479 11.403724 0 25.028023-4.242627 38.965453-12.292977l526.661931-335.111291c23.165606-13.406335 35.933397-29.556153 35.933397-44.925189 0-15.408945-12.728906-31.598672-34.967396-44.435025L253.588067 90.424452C240.66064 82.985016 227.061924 78.729086 215.644897 78.729086z" p-id="4450" fill="#cdcdcd"></path><path d="M485.556233 647.034463c-4.52199 0-8.924253-2.240017-11.510148-6.351662-3.990894-6.338359-2.081405-14.719236 4.25593-18.723434l7.333012-4.615111c6.351662-3.978614 14.731516-2.094708 18.723434 4.270257 4.00522 6.337335 2.095731 14.718213-4.25593 18.72241l-7.333012 4.616134C490.528478 646.357034 488.022401 647.034463 485.556233 647.034463z" p-id="4451" fill="#cdcdcd"></path><path d="M286.639834 772.143878c-4.520967 0-8.924253-2.240017-11.510148-6.351662-3.990894-6.337335-2.081405-14.731516 4.269233-18.72241l152.386666-95.859231c6.338359-3.964288 14.719236-2.094708 18.723434 4.270257 3.990894 6.337335 2.082428 14.731516-4.269233 18.723434l-152.386666 95.858208C291.612079 771.468496 289.106002 772.143878 286.639834 772.143878z" p-id="4452" fill="#cdcdcd"></path></svg>\n          </span>\n        `;a.innerHTML=s+n,t.appendChild(a)}),$(".podSounds ul").html(t)},saveSearchListPod:function(e){chrome.storage.local.get("sps_search_pod",function(t){let a=[];if(t.hasOwnProperty("sps_search_pod")&&t.sps_search_pod.length>0){const d=t.sps_search_pod.indexOf(e);d>=0&&t.sps_search_pod.splice(d,1),t.sps_search_pod.length>4&&t.sps_search_pod.splice(t.sps_search_pod.length-1,1),t.sps_search_pod.unshift(e),a=t.sps_search_pod}else a.push(e);let d=document.createDocumentFragment();a.forEach(e=>{let t=document.createElement("li");t.setAttribute("data-search",e),t.innerText=e,d.appendChild(t)}),$("#podHistory").html(d),chrome.storage.local.set({sps_search_pod:a},function(e){})})},renderHistoryDOM:function(){chrome.storage.local.get("sps_search_pod",function(e){if(e.hasOwnProperty("sps_search_pod")&&e.sps_search_pod.length>0){const t=e.sps_search_pod;let a=document.createDocumentFragment();t.forEach(e=>{let t=document.createElement("li");t.setAttribute("data-search",e),t.innerText=e,a.appendChild(t)}),$("#podHistory").html(a)}})},renderSongList:(e,t)=>{$(".lyricbox").addClass("hide"),$(".toplist_cont").addClass("hide"),$(".local_cont").addClass("hide"),$(`.nav-tabs li[data-name=${e}]`).addClass("active").siblings().removeClass("active");let a=document.createDocumentFragment();t.map((t,d)=>{let s=document.createElement("li");s.className="youtube"===e||"migu"===e?"youtube":"";let n=t.name;t.name.indexOf(" ")>0&&(n=t.name.replace(/\s/g,"_"));const c=t.album?t.album:"-",o=t.artists[0]?t.artists[0]:"Anonymous",l=`\n          <dl>\n              <dt>${t.name}</dt>\n              <dd>${o} | ${c} </dd>\n          </dl>\n          `;let r,i,p;try{p=`\n              <span class="open_span">\n                  <svg t="1553094862876" data-web=${e} data-page=${t.page} class="icon open_icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5011" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24"><defs><style type="text/css"></style></defs><path d="M895.739313 831.783187c0 34.726919-29.199019 63.956637-63.956637 63.956637l-641.659035 1.061169c-34.726919 0-62.894446-28.167526-62.894446-62.956867l1.030469-641.627313c0-34.788318 29.199019-63.956637 63.956637-63.956637l351.761506 0 0-63.956637-351.761506 0c-69.484537 0-127.913275 71.01438-127.913275 140.468219L64.303027 833.844126c0 69.51626 56.337099 125.852336 125.820614 125.852336l629.073392 0c69.483514 0 140.498918-58.46046 140.498918-127.913275l0-351.761506-63.956637 0L895.739313 831.783187zM926.99927 64.303538 703.869401 64.303538c-18.143219 0-31.94762 14.678304-31.978319 31.978319-0.031722 17.301038 13.8351 31.978319 31.978319 31.978319l140.529617-1.061169L361.944937 587.386968c-12.771885 12.178367-12.771885 31.914874 0 44.094264 12.742209 12.17939 33.44574 12.17939 46.219671 0l486.606657-464.183971 0.968048 152.833851c-0.031722 17.300015 13.8351 31.978319 31.978319 31.978319 18.143219-0.062422 31.946596-14.678304 31.978319-31.978319L959.69595 95.470375C959.726649 78.169337 945.173189 64.24214 926.99927 64.303538z" p-id="5012" fill="#cdcdcd"></path></svg>\n              </span>\n              `,i=`\n              <span class="range_span" data-toggle="modal" data-target="#rangeModal"\n                  data-id=${t.id} data-web=${e} data-name=${n} data-duration=${t.duration} data-artist=${t.artists[0]} data-cover=${t.cover} data-page=${t.page}\n              >\n                  <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n                      class="icon range_icon"\n                  >\n                      <path d="M17.621625,0.0080625 L3.247125,0.0080625 C1.46503535,0.00971641258 0.0207789126,1.45397285 0.019125,3.2360625 L0.019125,17.6120625 C0.019125,19.3925625 1.466625,20.8400625 3.247125,20.8400625 L17.621625,20.8400625 C19.4033725,20.8375838 20.8471463,19.39381 20.849625,17.6120625 L20.849625,3.2375625 C20.8487982,1.45488709 19.4042998,0.00971753164 17.621625,0.0080625 Z M17.623125,19.5028171 L3.33451116,19.5028171 C1.96663484,19.5011641 1.61708405,18.9814388 1.61543103,17.6135625 L1.61543103,3.2375625 C1.61543103,1.8710625 1.96801116,1.65393921 3.33451116,1.65393921 L16.9023024,1.65393921 C18.2688024,1.65393921 19.4451113,1.8710625 19.4451113,3.2375625 L19.4451113,17.6135625 C19.4466113,18.9800625 18.989625,19.5028171 17.623125,19.5028171 Z"\n                          id="Shape" fill-rule="nonzero" fill="#cdcdcd"></path>\n                      <path d="M14.165625,7.3265625 C14.0121539,7.1974948 13.7880961,7.1974948 13.634625,7.3265625 C13.5645546,7.38469743 13.5240112,7.47101567 13.5240112,7.5620625 C13.5240112,7.65310933 13.5645546,7.73942757 13.634625,7.7975625 L16.130625,10.0145625 L4.664625,10.0145625 L7.235625,7.7300625 C7.30569535,7.67192757 7.34623884,7.58560933 7.34623884,7.4945625 C7.34623884,7.40351567 7.30569535,7.31719743 7.235625,7.2590625 C7.08215391,7.1299948 6.85809609,7.1299948 6.704625,7.2590625 L3.445125,10.1555625 C3.37505465,10.2136974 3.33451116,10.3000157 3.33451116,10.3910625 C3.33451116,10.4821093 3.37505465,10.5684276 3.445125,10.6265625 L6.706125,13.5215625 C6.853125,13.6505625 7.090125,13.6505625 7.237125,13.5215625 C7.384125,13.3925625 7.384125,13.1810625 7.237125,13.0520625 L4.661625,10.7645625 L16.286625,10.7645625 L13.634625,13.1195625 C13.487625,13.2500625 13.487625,13.4615625 13.634625,13.5890625 C13.781625,13.7165625 14.018625,13.7180625 14.165625,13.5890625 L17.426625,10.6925625 C17.4966954,10.6344276 17.5372388,10.5481093 17.5372388,10.4570625 C17.5372388,10.3660157 17.4966954,10.2796974 17.426625,10.2215625 L14.165625,7.3265625 Z"\n                          id="Path" fill="#cdcdcd"></path>\n                  </svg>\n              </span>\n              `,r=`\n              <span class="play_span">\n                  <svg data-id=${t.id} data-web=${e} data-name=${n} data-artist=${t.artists[0]} data-duration=${t.duration} data-cover=${t.cover} data-page=${t.page} t="1519384078654" class="icon play_icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4449" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24"><defs><style type="text/css"></style></defs><path d="M215.618291 917.834029c-55.520501 0-93.25901-44.607964-93.25901-110.988814l0-671.442362c0-66.38085 37.738509-110.98779 93.285616-110.98779 21.22951 0 43.632753 6.590092 66.121953 19.571754L810.298362 380.317888c39.064714 22.529109 61.195757 55.017034 61.195757 90.87266 0 35.815717-22.01234 68.263733-62.018495 91.362824L282.721595 897.664663C259.224438 911.256216 236.847801 917.834029 215.618291 917.834029zM215.644897 78.729086c-34.794457 0-38.971593 39.634696-38.971593 56.673767l0 671.442362c0 17.040095 4.177136 56.67479 38.944987 56.67479 11.403724 0 25.028023-4.242627 38.965453-12.292977l526.661931-335.111291c23.165606-13.406335 35.933397-29.556153 35.933397-44.925189 0-15.408945-12.728906-31.598672-34.967396-44.435025L253.588067 90.424452C240.66064 82.985016 227.061924 78.729086 215.644897 78.729086z" p-id="4450" fill="#cdcdcd"></path><path d="M485.556233 647.034463c-4.52199 0-8.924253-2.240017-11.510148-6.351662-3.990894-6.338359-2.081405-14.719236 4.25593-18.723434l7.333012-4.615111c6.351662-3.978614 14.731516-2.094708 18.723434 4.270257 4.00522 6.337335 2.095731 14.718213-4.25593 18.72241l-7.333012 4.616134C490.528478 646.357034 488.022401 647.034463 485.556233 647.034463z" p-id="4451" fill="#cdcdcd"></path><path d="M286.639834 772.143878c-4.520967 0-8.924253-2.240017-11.510148-6.351662-3.990894-6.337335-2.081405-14.731516 4.269233-18.72241l152.386666-95.859231c6.338359-3.964288 14.719236-2.094708 18.723434 4.270257 3.990894 6.337335 2.082428 14.731516-4.269233 18.723434l-152.386666 95.858208C291.612079 771.468496 289.106002 772.143878 286.639834 772.143878z" p-id="4452" fill="#cdcdcd"></path></svg>\n              </span>\n              `}catch(e){}let h=`\n                  <div class="fav" data-id=${t.id} data-web=${e} data-name=${n} data-duration=${t.duration} data-artist=${t.artists[0]} data-cover=${t.cover} data-page=${t.page}>\n                      <svg t="1529741031163" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1954" xmlns:xlink="http://www.w3.org/1999/xlink" width="26" height="26"><defs><style type="text/css"></style></defs><path d="M953.903525 374.597607c-0.539282 7.172353-1.065262 14.34573-1.620917 21.517059-2.868327 36.999682-13.000082 72.074525-29.305443 105.235786-26.372647 53.638641-59.652612 102.738919-98.68765 148.022265-42.319851 49.093115-88.287789 94.559633-136.064932 138.256854-45.841048 41.926902-93.324502 81.921801-141.966339 120.555703-12.014638 9.54233-25.199938 14.910595-40.799218 13.325493-10.536984-1.070378-19.735483-5.29254-27.90863-11.768021-86.809111-68.778456-170.041768-141.531434-246.068302-222.239594-43.699268-46.390563-82.991156-96.128361-114.648157-151.665235-18.669198-32.750915-34.576493-66.61928-41.974997-103.814414-2.946099-14.811334-4.137227-29.971615-6.131651-44.972261-0.206708-1.553379-0.448208-3.101641-0.673335-4.652973 0-8.378831 0-16.757662 0-25.136493 0.286526-1.685385 0.677429-3.361561 0.843204-5.059226 0.701988-7.181563 1.02126-14.415314 2.045589-21.548782 7.463995-51.965535 26.5374-99.119485 59.960627-139.835815 43.541679-53.043077 98.837052-85.024465 167.968549-91.090625 35.568077-3.121084 69.935816 2.306532 103.06433 15.488763 37.759999 15.025205 69.594031 38.372959 96.105848 69.071122 4.311189 4.992711 8.40953 10.168594 12.904914 15.621792 1.2689-1.573845 2.355651-2.871397 3.387144-4.209882 21.905916-28.40084 48.380894-51.52449 79.980589-68.560492C640.726803 102.114702 690.157609 93.252871 742.156914 102.019535c60.551074 10.208503 109.529579 40.862663 148.105153 88.101547 36.941354 45.237297 57.025785 97.480148 62.065568 155.578358 0.60989 7.024997 1.054005 14.06432 1.574868 21.097504C953.903525 369.396141 953.903525 371.997386 953.903525 374.597607zM898.728902 371.052874c-0.6191-8.346085-0.99363-16.718777-1.89721-25.03314-5.063319-46.553269-22.228257-88.057545-53.768601-122.822326-42.201148-46.514383-94.556563-69.004607-157.803026-62.721507-43.496653 4.320399-80.099293 23.566742-111.041002 54.027497-20.995173 20.669762-36.102243 45.25367-47.571459 72.210625-2.979868 7.003508-7.963369 11.42726-15.755846 11.453866-7.812943 0.026606-12.828167-4.431939-15.813151-11.397584-9.66615-22.556739-21.629623-43.738154-38.071084-62.10343-35.843346-40.037878-79.982636-63.324234-134.297682-65.148789-50.1594-1.684362-94.006024 15.162328-129.962957 49.536206-59.815317 57.181327-79.199807 127.835504-64.35061 208.373795 5.638417 30.582529 19.49296 58.090023 34.577516 84.993766 30.517037 54.429657 69.413929 102.484116 112.274086 147.477866 71.876004 75.453483 150.243863 143.722332 231.604892 208.66646 3.069919 2.450818 4.858658 2.50403 7.960299 0.030699 45.74895-36.479843 90.509387-74.122161 133.786029-113.508193 47.140647-42.902112 92.65833-87.404676 134.357034-135.719054 37.751812-43.741223 69.933769-91.109044 94.385671-143.530974C891.321188 435.866019 898.244878 404.190599 898.728902 371.052874z" p-id="1955" fill="#fff"></path></svg>\n                  </div>\n              `;s.innerHTML="youtube"===e||"migu"===e?l+p+r:l+p+i+r+h,a.appendChild(s)}),$(".music article > ul.search_cont").html(a)},renderFMHK:(e,t)=>{let a=document.createDocumentFragment();t.map((e,t)=>{let d=document.createElement("li");e.type&&"web"===e.type?d.innerHTML=`\n            <dl>\n                <dt>${e.title}</dt>\n                <dd>${e.desc}</dd>\n            </dl>\n            <span class="open_span">\n                <svg t="1553094862876" data-page=${e.address} class="icon open_icons open_radio" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5011" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24"><defs><style type="text/css"></style></defs><path d="M895.739313 831.783187c0 34.726919-29.199019 63.956637-63.956637 63.956637l-641.659035 1.061169c-34.726919 0-62.894446-28.167526-62.894446-62.956867l1.030469-641.627313c0-34.788318 29.199019-63.956637 63.956637-63.956637l351.761506 0 0-63.956637-351.761506 0c-69.484537 0-127.913275 71.01438-127.913275 140.468219L64.303027 833.844126c0 69.51626 56.337099 125.852336 125.820614 125.852336l629.073392 0c69.483514 0 140.498918-58.46046 140.498918-127.913275l0-351.761506-63.956637 0L895.739313 831.783187zM926.99927 64.303538 703.869401 64.303538c-18.143219 0-31.94762 14.678304-31.978319 31.978319-0.031722 17.301038 13.8351 31.978319 31.978319 31.978319l140.529617-1.061169L361.944937 587.386968c-12.771885 12.178367-12.771885 31.914874 0 44.094264 12.742209 12.17939 33.44574 12.17939 46.219671 0l486.606657-464.183971 0.968048 152.833851c-0.031722 17.300015 13.8351 31.978319 31.978319 31.978319 18.143219-0.062422 31.946596-14.678304 31.978319-31.978319L959.69595 95.470375C959.726649 78.169337 945.173189 64.24214 926.99927 64.303538z" p-id="5012" fill="#cdcdcd"></path></svg>\n            </span>\n            `:d.innerHTML=`\n            <dl>\n                <dt>${e.title}</dt>\n                <dd>${e.desc}</dd>\n            </dl>\n            <span>\n                <svg data-m3u8=${e.address} data-radio=${e.title} t="1519384078654" class="m3u8" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4449" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24"><defs><style type="text/css"></style></defs><path d="M215.618291 917.834029c-55.520501 0-93.25901-44.607964-93.25901-110.988814l0-671.442362c0-66.38085 37.738509-110.98779 93.285616-110.98779 21.22951 0 43.632753 6.590092 66.121953 19.571754L810.298362 380.317888c39.064714 22.529109 61.195757 55.017034 61.195757 90.87266 0 35.815717-22.01234 68.263733-62.018495 91.362824L282.721595 897.664663C259.224438 911.256216 236.847801 917.834029 215.618291 917.834029zM215.644897 78.729086c-34.794457 0-38.971593 39.634696-38.971593 56.673767l0 671.442362c0 17.040095 4.177136 56.67479 38.944987 56.67479 11.403724 0 25.028023-4.242627 38.965453-12.292977l526.661931-335.111291c23.165606-13.406335 35.933397-29.556153 35.933397-44.925189 0-15.408945-12.728906-31.598672-34.967396-44.435025L253.588067 90.424452C240.66064 82.985016 227.061924 78.729086 215.644897 78.729086z" p-id="4450" fill="#cdcdcd"></path><path d="M485.556233 647.034463c-4.52199 0-8.924253-2.240017-11.510148-6.351662-3.990894-6.338359-2.081405-14.719236 4.25593-18.723434l7.333012-4.615111c6.351662-3.978614 14.731516-2.094708 18.723434 4.270257 4.00522 6.337335 2.095731 14.718213-4.25593 18.72241l-7.333012 4.616134C490.528478 646.357034 488.022401 647.034463 485.556233 647.034463z" p-id="4451" fill="#cdcdcd"></path><path d="M286.639834 772.143878c-4.520967 0-8.924253-2.240017-11.510148-6.351662-3.990894-6.337335-2.081405-14.731516 4.269233-18.72241l152.386666-95.859231c6.338359-3.964288 14.719236-2.094708 18.723434 4.270257 3.990894 6.337335 2.082428 14.731516-4.269233 18.723434l-152.386666 95.858208C291.612079 771.468496 289.106002 772.143878 286.639834 772.143878z" p-id="4452" fill="#cdcdcd"></path></svg>\n            </span>\n            `,a.appendChild(d)}),$(".radio article > ul").html(a),$(".radio .lyricbox").addClass("hide")},renderFMHome:(e,t)=>{let a=document.createDocumentFragment();t.map((e,t)=>{let d,s=document.createElement("li");try{d=e.nowplaying.title?e.nowplaying.title:"-"}catch(e){d="-"}s.innerHTML=`\n              <dl>\n                  <dt>${e.title}</dt>\n                  <dd>正在播放:${d}</dd>\n              </dl>\n              <span>\n              <svg data-id=${e.content_id} data-radio=${e.title} t="1519384078654" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4449" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24"><defs><style type="text/css"></style></defs><path d="M215.618291 917.834029c-55.520501 0-93.25901-44.607964-93.25901-110.988814l0-671.442362c0-66.38085 37.738509-110.98779 93.285616-110.98779 21.22951 0 43.632753 6.590092 66.121953 19.571754L810.298362 380.317888c39.064714 22.529109 61.195757 55.017034 61.195757 90.87266 0 35.815717-22.01234 68.263733-62.018495 91.362824L282.721595 897.664663C259.224438 911.256216 236.847801 917.834029 215.618291 917.834029zM215.644897 78.729086c-34.794457 0-38.971593 39.634696-38.971593 56.673767l0 671.442362c0 17.040095 4.177136 56.67479 38.944987 56.67479 11.403724 0 25.028023-4.242627 38.965453-12.292977l526.661931-335.111291c23.165606-13.406335 35.933397-29.556153 35.933397-44.925189 0-15.408945-12.728906-31.598672-34.967396-44.435025L253.588067 90.424452C240.66064 82.985016 227.061924 78.729086 215.644897 78.729086z" p-id="4450" fill="#cdcdcd"></path><path d="M485.556233 647.034463c-4.52199 0-8.924253-2.240017-11.510148-6.351662-3.990894-6.338359-2.081405-14.719236 4.25593-18.723434l7.333012-4.615111c6.351662-3.978614 14.731516-2.094708 18.723434 4.270257 4.00522 6.337335 2.095731 14.718213-4.25593 18.72241l-7.333012 4.616134C490.528478 646.357034 488.022401 647.034463 485.556233 647.034463z" p-id="4451" fill="#cdcdcd"></path><path d="M286.639834 772.143878c-4.520967 0-8.924253-2.240017-11.510148-6.351662-3.990894-6.337335-2.081405-14.731516 4.269233-18.72241l152.386666-95.859231c6.338359-3.964288 14.719236-2.094708 18.723434 4.270257 3.990894 6.337335 2.082428 14.731516-4.269233 18.723434l-152.386666 95.858208C291.612079 771.468496 289.106002 772.143878 286.639834 772.143878z" p-id="4452" fill="#cdcdcd"></path></svg>\n          </span>\n          `,a.appendChild(s)}),$(".radio article > ul").html(a),$(".radio .lyricbox").addClass("hide")},getObjectStore:function(e,t){return db.transaction(e,t).objectStore(e)},clearObjectStore(e){var t=Pod.method.getObjectStore(Pod.DB_STORE_NAME,"readwrite").clear();t.onsuccess=function(e){},t.onerror=function(e){}},openDb:function(){var e=indexedDB.open(Pod.DB_NAME,Pod.DB_VERSION);e.onsuccess=function(e){db=this.result,chrome.storage.local.get({slide:1,lastSearch:"undefined"},e=>{e.lastSearch===["fm","song","podcast"][e.slide]&&Pod.M.getDB(e.lastSearch)})},e.onerror=function(e){},e.onupgradeneeded=function(e){e.currentTarget.result.createObjectStore(Pod.DB_STORE_NAME,{keyPath:"type"}).createIndex("search","search",{unique:!1})}},addDB:function(e,t){const a={search:e,searchList:t,type:"podcast"};var d,s=Pod.method.getObjectStore(Pod.DB_STORE_NAME,"readwrite");try{d=s.add(a)}catch(e){if("DataCloneError"==e.name)throw e}d.onsuccess=function(e){},d.onerror=function(){}},updateDB:function(e){const t=e.type;var a=db.transaction([Pod.DB_STORE_NAME],"readwrite").objectStore(Pod.DB_STORE_NAME),d=a.get(t);d.onerror=function(e){},d.onsuccess=function(t){var d=t.target.result;if(d&&d.hasOwnProperty("search")){var s=a.put(e);s.onerror=function(e){},s.onsuccess=function(e){console.log("update done:",e)}}else{var n,c=Pod.method.getObjectStore(Pod.DB_STORE_NAME,"readwrite");try{n=c.add(e)}catch(e){if("DataCloneError"==e.name)throw e}n.onsuccess=function(e){console.log("Insertion in DB successful")},n.onerror=function(){console.error("addPublication error",this.error)}}}},getDB:function(e,t){const a=db.transaction([Pod.DB_STORE_NAME],"readwrite").objectStore(Pod.DB_STORE_NAME).get(e);a.onerror=function(){},a.onsuccess=function(a){const d=a.target.result;switch(e){case"song":chrome.storage.sync.get("customHomeMode",function(e){try{e.customHomeMode===Pod.HOME_SEARCH_MODE&&Pod.M.renderSongList(d.web,d.searchList)}catch(e){}});break;case"podcast":(e=>{const t=d.sub;if($("#podcast .desc").addClass("hide"),"album"===t)$(".podAlbums").removeClass("hide"),$(".podSounds").addClass("hide"),$(".podSounds ul").html(""),Pod.M.renderAlbums(d.searchList);else if("detail"===t)if($(".podSounds").removeClass("hide"),$(".podAlbums").addClass("hide"),$(".podAlbums ul").html(""),e){const e=d.searchList.reverse();Pod.M.renderSounds(e),Pod.M.updateDB({search:"",searchList:e,type:"podcast",sub:"detail"})}else Pod.M.renderSounds(d.searchList)})(t);break;case"fm":"hk"===(s=d.search)?Pod.M.renderFMHK("hk",d.searchList):"home"===s&&Pod.M.renderFMHome("home",d.searchList)}var s}}},subscribe:[{base:"#podSearch",bind:"",callback:()=>{$("#podcast .desc").addClass("hide"),$(".podAlbums").removeClass("hide"),$(".podSounds").addClass("hide"),$(".podSounds ul").html("");const e=Pod.$input.val();Pod.M.saveSearchListPod(e),Itunes.search(e).then(t=>{Pod.M.renderAlbums(t),chrome.storage.local.set({lastSearch:"podcast"},()=>{Pod.M.updateDB({search:e,searchList:t,type:"podcast",sub:"album"})})})}},{base:"#podInput",bind:"",event:"keypress",callback:e=>{if("13"==e.keyCode){$("#podcast .desc").addClass("hide"),$(".podAlbums").removeClass("hide"),$(".podSounds").addClass("hide"),$(".podSounds ul").html("");const e=Pod.$input.val();Pod.M.saveSearchListPod(e),Itunes.search(e).then(t=>{Pod.M.renderAlbums(t),chrome.storage.local.set({lastSearch:"podcast"},()=>{Pod.M.updateDB({search:e,searchList:t,type:"podcast",sub:"album"})})})}}},{base:document,bind:".podAlbums .imgWrap img",callback:e=>{$(".podSounds").removeClass("hide"),$(".podAlbums").addClass("hide"),$(".podAlbums ul").html("");const t=$(e.target).data("xml");Itunes.list(t).then(e=>{Pod.M.updateDB({search:"",searchList:e,type:"podcast",sub:"detail"}),Pod.M.renderSounds(e)})}},{base:document,bind:".itune_play",callback:e=>{const t={type:"itunes",url:$(e.target).data("url"),name:$(e.target).data("title"),index:$(e.target).parents("li").index()};chrome.runtime.connect().postMessage(t)}},{base:".switchWrap",bind:"",callback:()=>{if($(".switchWrap").hasClass("active"))$(".switchWrap").removeClass("active"),$("#podcast ul").animate({scrollTop:0},500);else{$(".switchWrap").addClass("active");const e=60*$(".podSounds ul li").length+"px";$("#podcast ul").animate({scrollTop:e},500)}}},{base:".padSwitch",bind:"",callback:()=>{$(".padSwitch").toggleClass("active"),Pod.M.getDB("podcast","reset")}},{base:document,bind:"#podHistory li",callback:e=>{const t=$(e.target).data("search");Pod.M.saveSearchListPod(t),Pod.M.addDB(t),$("#podcast .desc").addClass("hide"),$(".podAlbums").removeClass("hide"),$(".podSounds").addClass("hide"),$(".podSounds ul").html(""),Itunes.search(t).then(e=>{Pod.M.renderAlbums(e),chrome.storage.local.set({lastSearch:"podcast"},()=>{Pod.M.updateDB({search:"",searchList:e,type:"podcast",sub:"album"})})})}}],init:()=>{Pod.method.renderHistoryDOM(),Pod.method.openDb(),Pod.subscribe.map(e=>{const t=e.event?e.event:"click";e.bind?$(e.base).on(t,e.bind,e.callback):$(e.base).on(t,e.callback)})}};Pod.M=Pod.method,Pod.init();